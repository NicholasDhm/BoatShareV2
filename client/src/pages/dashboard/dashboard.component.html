<div class="dashboard-container">
  <!-- Dashboard Header with User Info -->
  <div class="dashboard-header">
    <div class="user-welcome">
      <h1>Painel de Controle</h1>
      @if (currentUser) {
        <p class="welcome-text">Bem-vindo, <strong class="username">{{ currentUser.name }}</strong> â€” Navegue pelas suas reservas</p>
      }
    </div>
    
    @if (validationError) {
      <div class="error-message">
        <i class="bi bi-exclamation-triangle"></i>
        {{ validationError }}
      </div>
    }
  </div>

  <!-- Main Dashboard Content -->
  <div class="dashboard-content">
    <!-- Left Sidebar - Reservation Info -->
    <div class="dashboard-sidebar">
      @if (calendarViewModel && currentUser) {
        <ui-card class="quota-card" gapStyle="none">
          <ui-reservation-description [user]="currentUser"></ui-reservation-description>
        </ui-card>

        <!-- Quick Stats -->
        <ui-card class="stats-card" layout="vertical" gapStyle="small">
          <h3>EstatÃ­sticas</h3>
          <div class="stats-grid">
            <div class="stat-item">
              <span class="stat-number">{{ getActiveQuotas() }}</span>
              <span class="stat-label">Cotas Ativas</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">{{ getInactiveQuotas() }}</span>
              <span class="stat-label">Cotas Inativas</span>
            </div>
          </div>
        </ui-card>

        <!-- Legend -->
        <ui-card class="legend-card" layout="vertical" gapStyle="small">
          <h3>Legenda</h3>
          <div class="legend-items">
            <div class="legend-item">
              <span class="legend-dot standard"></span>
              <span>PadrÃ£o</span>
            </div>
            <div class="legend-item">
              <span class="legend-dot substitution"></span>
              <span>SuplÃªncia</span>
            </div>
            <div class="legend-item">
              <span class="legend-dot contingency"></span>
              <span>ContingÃªncia</span>
            </div>
            <div class="legend-item">
              <span class="legend-dot disabled"></span>
              <span>IndisponÃ­vel</span>
            </div>
            <div class="legend-item">
              <span class="legend-dot other-month"></span>
              <span>Outro MÃªs</span>
            </div>
          </div>
        </ui-card>
      }
    </div>

    <!-- Calendar Section -->
    <div class="calendar-section">
      @if (calendarViewModel) {
        <ui-calendar
          [calendarViewModel]="calendarViewModel"
          (selectedDay)="onDaySelected($event)"
          (monthChanged)="onMonthChanged($event)">
        </ui-calendar>
      } @else {
        <div class="loading-state">
          <ui-loading-spinner></ui-loading-spinner>
          <p>Carregando calendÃ¡rio...</p>
        </div>
      }
    </div>
  </div>
</div>

<!-- ðŸ“† Reservation Modal -->
@if (showModal) {
  <app-reservation-modal
    [userReservationToDisplay]="userReservationToDisplay"
    [firstReservationToDisplay]="firstReservationToDisplay"
    [activeUser]="currentUser"
    [firstReservationUserName]="firstReservationUserName"
    (close)="closeModal()"
    (newReservation)="makeReservation($event)"
    (cancelReservation)="cancelReservation($event)"
    (confirmReservation)="confirmReservation($event)">
  </app-reservation-modal>
}
